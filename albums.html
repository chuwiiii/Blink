<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Albums</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lato:ital@1&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css">
  </head>

  
<body>
    <a href="index.html"><img src="./Assets/logo3.png" /></a>
    <section class="header">
    <nav>
        <div class="nav-links" id="navLinks">
            <i class="fas fa-times-circle" onclick="hideMenu()"></i>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="members.html">Members</a></li>
            <li><a href="albums.html">Albums</a></li>
          </ul>
        </div>
        <i class="fas fa-bars" onclick="openMenu()"></i>
      </nav>
    </section>
    <section class="albums">
        <h1>Albums</h1>
        <div class="row">
          <div class="albums-col" id="squareUpAlbum">
              <img src="./Assets/square up.png" id="SQ">
                <div class="audio-bar">
                  <input type="range" value="0" id="progress">
                </div>
            <h4>SQUARE UP</h4>
            <p1>
              <span id="dduDu">Ddu-Du Ddu-Du (뚜두뚜두)</span><br>
              <span id="foreverYoung">Forever Young</span><br>
              <span id="Really">Really</span><br>
              <span id="seeUlater">See U Later</span><br>
              <span id="AIIYL">As If It's Your Last (마지막처럼)</span><br>
            </p1>
          </div>
    </section>

    <audio id="SQAlbum">
      <source src="./Assets/[Full Mini Album] SQUARE UP.mp3" type="audio/mp3">
    </audio>

    //button
    <button id="SQ">Play</button>
    <input type="range" id="progress" min="0" value="0">
</body>

  <script>

    //audio
    let progress = document.getElementById("progress");

    var audioElements = [    
    document.getElementById("SQAlbum")
    ];

    var playButtons = [
    document.getElementById("SQ")
    ];

    var currentAudio = null;

    function stopAllAudio() {
    audioElements.forEach(function (audio, index) {
        audio.pause();
        playButtons[index].innerHTML = "Play";
    });
}

playButtons.forEach(function (button, index) {
    button.addEventListener("click", function () {
        if (currentAudio !== audioElements[index]) {
            stopAllAudio();
            audioElements[index].play();
            currentAudio = audioElements[index];
            button.innerHTML = "Pause";
        } else {
            if (currentAudio.paused) {
                currentAudio.play();
                button.innerHTML = "Pause";
            } else {
                currentAudio.pause();
                button.innerHTML = "Play";
            }
        }
    });
});

audioElements.forEach(function (audio, index) {
    audio.addEventListener("loadedmetadata", function () {
        progress.max = audio.duration;
    });

    audio.addEventListener("timeupdate", function () {
        progress.value = audio.currentTime;
    });

    audio.addEventListener("ended", function () {
        clearInterval(updateProgress);
    });
});

progress.addEventListener("input", function () {
    currentAudio.currentTime = progress.value;
});

let updateProgress = setInterval(function () {
    if (!currentAudio.paused) {
        progress.value = currentAudio.currentTime;
    }
}, 500);

//song timeline

var dduDuTime = 0;
var transitionBackTime = 60;
var dduDuTextColor = "red";

audioElements.forEach(function (audio, index) {
    audio.addEventListener("timeupdate", function () {
        progress.value = audio.currentTime;

        // check the current time and apply or remove the text color
        if (audio.currentTime >= dduDuTime) {
            document.getElementById("dduDu").style.color = dduDuTextColor;
        } else {
            document.getElementById("dduDu").style.color = "black";
        }

        // check if the audio time is close to transitioning sa next song
        if (audio.currentTime >= transitionBackTime) {
            document.getElementById("dduDu").style.color = "black";
        }
    });
});





    //navigation menu

    var navLinks = document.getElementById("navLinks");


    function hideMenuOnLoad() {
        navLinks.style.right = "-200px";
    }

    window.addEventListener('load', hideMenuOnLoad);

    function openMenu() {
        navLinks.style.right = "0";
    }

    function hideMenu() {
        navLinks.style.right = "-200px";
    }

  </script>
</html>